<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jacob Gipson and Tavin Weeda" />


<title>Beer</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="AboutMe.html">About me</a>
</li>
<li>
  <a href="Iris.html">Iris</a>
</li>
<li>
  <a href="Beers_Final.html">Beers</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Beer</h1>
<h4 class="author">Jacob Gipson and Tavin Weeda</h4>
<h4 class="date">10/9/2021</h4>

</div>


<div id="beer-eda" class="section level1">
<h1>Beer EDA</h1>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<div id="hello-the-following-is-the-process-we-went-through-to-explore-some-of-the-questions-that-you-the-ceo-and-cfo-of-budweiser-wanted-to-answer.-we-hope-that-you-find-these-discoveries-not-only-interesting-but-also-powerful-and-of-use-for-future-business-decisions.-let-us-begin." class="section level5">
<h5>Hello, the following is the process we went through to explore some of the questions that you, the CEO and CFO of Budweiser, wanted to answer. We hope that you find these discoveries not only interesting, but also powerful and of use for future business decisions. Let us begin.</h5>
<pre class="r"><code>#upload beer and breweries data
beers = read.csv(&quot;/Users/jacobgipson/Documents/SMU/Doing Data science/Beers Project/Beers.csv&quot;, header = TRUE, na.strings = c(&quot;&quot;,&quot; &quot;,&quot;NA&quot;))
breweries = read.csv(&quot;/Users/jacobgipson/Documents/SMU/Doing Data science/Beers Project/Breweries.csv&quot;, header = TRUE, na.strings = c(&quot;&quot;,&quot; &quot;,&quot;NA&quot;))</code></pre>
</div>
</div>
<div id="question-1-how-many-breweries-are-in-each-state" class="section level3">
<h3>Question 1: How many breweries are in each state?</h3>
<div id="we-created-a-table-and-a-corresponding-bar-chart-to-visualize-the-number-of-individual-breweries-in-each-state." class="section level5">
<h5>We created a table and a corresponding bar chart to visualize the number of individual breweries in each state.</h5>
<pre class="r"><code>library(ggplot2)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>library(ggthemes)</code></pre>
<pre><code>## Warning: package &#39;ggthemes&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.0.2</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(RColorBrewer)
####This creates a custom color palette

  # Classic palette BuPu, with 4 colors
  coul &lt;- brewer.pal(4, &quot;PuOr&quot;) 

  # Add more colors to this palette :
  coul &lt;- colorRampPalette(coul)(51)

##Make Brewery count graph
 
brewerycount = data.frame(table(breweries[&#39;State&#39;]))
colnames(brewerycount) = c(&#39;State&#39;, &#39;BrewCount&#39;)
brewerycount</code></pre>
<pre><code>##    State BrewCount
## 1     AK         7
## 2     AL         3
## 3     AR         2
## 4     AZ        11
## 5     CA        39
## 6     CO        47
## 7     CT         8
## 8     DC         1
## 9     DE         2
## 10    FL        15
## 11    GA         7
## 12    HI         4
## 13    IA         5
## 14    ID         5
## 15    IL        18
## 16    IN        22
## 17    KS         3
## 18    KY         4
## 19    LA         5
## 20    MA        23
## 21    MD         7
## 22    ME         9
## 23    MI        32
## 24    MN        12
## 25    MO         9
## 26    MS         2
## 27    MT         9
## 28    NC        19
## 29    ND         1
## 30    NE         5
## 31    NH         3
## 32    NJ         3
## 33    NM         4
## 34    NV         2
## 35    NY        16
## 36    OH        15
## 37    OK         6
## 38    OR        29
## 39    PA        25
## 40    RI         5
## 41    SC         4
## 42    SD         1
## 43    TN         3
## 44    TX        28
## 45    UT         4
## 46    VA        16
## 47    VT        10
## 48    WA        23
## 49    WI        20
## 50    WV         1
## 51    WY         4</code></pre>
<pre class="r"><code>brewerycount %&gt;%
  ggplot(aes(x = reorder(State, BrewCount), y = BrewCount, fill = State)) +
  theme_classic() +
  geom_bar(stat = &quot;identity&quot;,fill=coul)+
  coord_flip() + 
  theme(legend.position = &quot;none&quot;) + 
  ylab(&quot;Number of Breweries&quot;) +
  xlab(&quot;State&quot;) +
  ggtitle(&quot;Number of Breweries in Each State&quot;) </code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
</div>
<div id="question-2-merge-beer-data-with-the-breweries-data.-print-the-first-6-observations-and-the-last-six-observations-to-check-the-merged-file.-rmd-only-this-does-not-need-to-be-included-in-the-presentation-or-the-deck." class="section level3">
<h3>Question 2: Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file. (RMD only, this does not need to be included in the presentation or the deck.)</h3>
<div id="we-merged-the-two-data-sets-using-left_join-by-the-variable-brewery_id." class="section level5">
<h5>We merged the two data sets using left_join by the variable Brewery_id.</h5>
<pre class="r"><code>colnames(breweries)[1] = &quot;Brewery_id&quot;
colnames(breweries)[2] = &quot;Brewery Name&quot;
fullbeer &lt;- left_join(beers, breweries, by = &quot;Brewery_id&quot;)
head(fullbeer, n = 6)</code></pre>
<pre><code>##                  Name Beer_ID   ABV IBU Brewery_id
## 1            Pub Beer    1436 0.050  NA        409
## 2         Devil&#39;s Cup    2265 0.066  NA        178
## 3 Rise of the Phoenix    2264 0.071  NA        178
## 4            Sinister    2263 0.090  NA        178
## 5       Sex and Candy    2262 0.075  NA        178
## 6        Black Exodus    2261 0.077  NA        178
##                            Style Ounces              Brewery Name City State
## 1            American Pale Lager     12 10 Barrel Brewing Company Bend    OR
## 2        American Pale Ale (APA)     12       18th Street Brewery Gary    IN
## 3                   American IPA     12       18th Street Brewery Gary    IN
## 4 American Double / Imperial IPA     12       18th Street Brewery Gary    IN
## 5                   American IPA     12       18th Street Brewery Gary    IN
## 6                  Oatmeal Stout     12       18th Street Brewery Gary    IN</code></pre>
<pre class="r"><code>tail(fullbeer, n = 6)</code></pre>
<pre><code>##                             Name Beer_ID   ABV IBU Brewery_id
## 2405 Rocky Mountain Oyster Stout    1035 0.075  NA        425
## 2406                   Belgorado     928 0.067  45        425
## 2407               Rail Yard Ale     807 0.052  NA        425
## 2408             B3K Black Lager     620 0.055  NA        425
## 2409         Silverback Pale Ale     145 0.055  40        425
## 2410        Rail Yard Ale (2009)      84 0.052  NA        425
##                         Style Ounces            Brewery Name   City State
## 2405           American Stout     12 Wynkoop Brewing Company Denver    CO
## 2406              Belgian IPA     12 Wynkoop Brewing Company Denver    CO
## 2407 American Amber / Red Ale     12 Wynkoop Brewing Company Denver    CO
## 2408              Schwarzbier     12 Wynkoop Brewing Company Denver    CO
## 2409  American Pale Ale (APA)     12 Wynkoop Brewing Company Denver    CO
## 2410 American Amber / Red Ale     12 Wynkoop Brewing Company Denver    CO</code></pre>
</div>
</div>
<div id="question-3-address-the-missing-values-in-each-column." class="section level3">
<h3>Question 3: Address the missing values in each column.</h3>
<div id="we-filled-in-missing-abv-and-ibu-values-with-averages-for-the-beers-style.-other-missing-values-required-a-little-more-due-diligence-which-we-have-outlined-below." class="section level5">
<h5>We filled in missing ABV and IBU values with averages for the beer’s style. Other missing values required a little more due diligence which we have outlined below.</h5>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  3.1.5     ✓ purrr   0.3.4
## ✓ tidyr   1.1.0     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 4.0.2</code></pre>
<pre><code>## ── Conflicts ──────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>#Number of missing ABV values
sum(is.na(fullbeer$ABV))</code></pre>
<pre><code>## [1] 62</code></pre>
<pre class="r"><code>#Number of missing IBU values
sum(is.na(fullbeer$IBU))</code></pre>
<pre><code>## [1] 1005</code></pre>
<pre class="r"><code>#Number of missing styles
sum(is.na(fullbeer$Style))</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="r"><code>fullbeer$Style = as.factor(fullbeer$Style)
styles_list&lt;-unique(fullbeer$Style)

#Fill in missing IBU Values with mean IBU value of the style of beer
 for(sty in 1:length(styles_list)){
    l&lt;-fullbeer[fullbeer$Style==styles_list[sty],]
    m&lt;-l[!(is.na(l$IBU)),]
    n&lt;-mean(m$IBU)
   fullbeer$IBU[fullbeer$Style==styles_list[sty] &amp; is.na(fullbeer$IBU)]&lt;-n
 }

#Fill in missing ABV Values with mean ABV value of the style of beer
 for(sty in 1:length(styles_list)){
    l&lt;-fullbeer[fullbeer$Style==styles_list[sty],]
    m&lt;-l[!(is.na(l$ABV)),]
    n&lt;-mean(m$ABV)
   fullbeer$ABV[fullbeer$Style==styles_list[sty] &amp; is.na(fullbeer$ABV)]&lt;-n
 }

#No more missing ABV values
sum(is.na(fullbeer$ABV))</code></pre>
<pre><code>## [1] 3</code></pre>
<pre class="r"><code>#We still have 52 missing IBU values
sum(is.na(fullbeer$IBU))</code></pre>
<pre><code>## [1] 55</code></pre>
<pre class="r"><code>#We assume all mead and ciders should have an IBU of 0 as they generally do not come with an IBU value.
#The rest of the styles were looked up.
fullbeer$IBU[fullbeer$Style == &quot;Cider&quot;] = 0
fullbeer$IBU[fullbeer$Style == &quot;Mead&quot;] = 0
fullbeer$IBU[fullbeer$Style == &quot;Rauchbier&quot;] = 0
fullbeer$IBU[fullbeer$Style == &quot;Shandy&quot;] = 0
fullbeer$IBU[fullbeer$Style == &quot;American Malt Liquor&quot;] = 0
fullbeer$IBU[fullbeer$Style == &quot;Kristalweizen&quot;] = 40
fullbeer$IBU[fullbeer$Style == &quot;Flanders Red Ale&quot;] = 59
fullbeer$IBU[fullbeer$Style == &quot;Braggot&quot;] = 12
fullbeer$IBU[fullbeer$Style == &quot;Low Alcohol Beer&quot;] = 0

#No more missing IBU values
sum(is.na(fullbeer$IBU))</code></pre>
<pre><code>## [1] 3</code></pre>
<pre class="r"><code># 5 rows are missing styles.  2527 and 1635 are actual beers.  The other 3 are not specific beers so they were removed
fullbeer$Style = as.character(fullbeer$Style)

#OktoberFiesta
fullbeer$Style[fullbeer$Beer_ID == 2527] = &quot;MÃ¤rzen / Oktoberfest&quot;

#Kilt Lifter
fullbeer$Style[fullbeer$Beer_ID == 1635] = &quot;Scottish Ale&quot;

#removed Special Release (new special release every month),The CROWLER (this is the can not the beer), 
#CAN&#39;D AID Foundation, (this is an event not one specific beer)
fullbeer&lt;-fullbeer[!(fullbeer$Beer_ID == 2210 | fullbeer$Beer_ID==1796|fullbeer$Beer_ID==1790),]

fullbeer$Style = as.factor(fullbeer$Style)

#Now no more missing styles
sum(is.na(fullbeer$style)) </code></pre>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="question-4-compute-the-median-alcohol-content-and-international-bitterness-unit-for-each-state.-plot-a-bar-chart-to-compare." class="section level3">
<h3>Question 4: Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.</h3>
<div id="we-created-a-table-and-corresponding-bar-charts-to-display-the-median-abv-and-ibu-values-for-each-state" class="section level5">
<h5>We created a table and corresponding bar charts to display the median ABV and IBU values for each state</h5>
<pre class="r"><code>library(dplyr)
fullbeer$State = as.factor(fullbeer$State)
medians = fullbeer %&gt;%
  group_by(State) %&gt;%
  summarise(medianABV = median(ABV), medianIBU = median(IBU))

medians$medianABV&lt;-round(medians$medianABV*100,digits=1)
medians$medianIBU&lt;-round(medians$medianIBU,digits=1)

medians</code></pre>
<pre><code>## # A tibble: 51 × 3
##    State medianABV medianIBU
##    &lt;fct&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 &quot; AK&quot;       5.6      33.8
##  2 &quot; AL&quot;       6        39.5
##  3 &quot; AR&quot;       5.2      36.3
##  4 &quot; AZ&quot;       5.7      22.2
##  5 &quot; CA&quot;       5.8      40  
##  6 &quot; CO&quot;       6        36.3
##  7 &quot; CT&quot;       6        36.3
##  8 &quot; DC&quot;       6.2      28.1
##  9 &quot; DE&quot;       6        59.8
## 10 &quot; FL&quot;       5.6      35.6
## # … with 41 more rows</code></pre>
<pre class="r"><code>medians %&gt;%
  ggplot(aes(y = reorder(State, medianABV), x = medianABV, fill = State)) +
  geom_bar(stat = &quot;identity&quot;,fill=coul) +
  theme_clean() +
  theme(legend.position = &quot;none&quot;) + 
  ylab(&quot;State&quot;) +
  xlab(&quot;ABV (%)&quot;) +
  ggtitle(&quot;Median Beer ABV in Each State&quot;)+coord_cartesian(xlim=c(3,7))</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>medians %&gt;%
  ggplot(aes(y = reorder(State, medianIBU), x = medianIBU, fill = State)) +
  geom_bar(stat = &quot;identity&quot;,fill=coul) +
  theme_clean() +
  theme(legend.position = &quot;none&quot;) + 
  ylab(&quot;IBU&quot;) +
  xlab(&quot;State&quot;) +
  ggtitle(&quot;Median Beer IBU in Each State&quot;)+coord_cartesian(xlim=c(15,70))</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
</div>
</div>
<div id="question-5-which-state-has-the-maximum-alcoholic-abv-beer-which-state-has-the-most-bitter-ibu-beer" class="section level3">
<h3>Question 5: Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?</h3>
<div id="we-found-that-the-lee-hill-series-vol.-5---belgian-style-quadrupel-ale-from-colorado-had-the-highest-abv-in-our-data-set.-this-beer-had-an-abv-of-0.128-or-12.8" class="section level5">
<h5>We found that the Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale from Colorado had the highest ABV in our data set. This beer had an ABV of 0.128 or 12.8%!</h5>
</div>
<div id="we-found-that-the-bitter-bitch-imperial-ipa-from-oregon-had-the-highest-ibu-in-our-data-set.-this-beer-had-an-ibu-of-138" class="section level5">
<h5>We found that the Bitter Bitch Imperial IPA from Oregon had the highest IBU in our data set. This beer had an IBU of 138!</h5>
<pre class="r"><code>#Highest ABV
fullbeer[which.max(fullbeer$ABV),]</code></pre>
<pre><code>##                                                      Name Beer_ID   ABV IBU
## 2279 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale    2565 0.128  24
##      Brewery_id            Style Ounces            Brewery Name    City State
## 2279         52 Quadrupel (Quad)   19.2 Upslope Brewing Company Boulder    CO</code></pre>
<pre class="r"><code>#Most Bitter - Highest IBU
fullbeer[which.max(fullbeer$IBU),]</code></pre>
<pre><code>##                          Name Beer_ID   ABV IBU Brewery_id
## 148 Bitter Bitch Imperial IPA     980 0.082 138        375
##                              Style Ounces            Brewery Name    City State
## 148 American Double / Imperial IPA     12 Astoria Brewing Company Astoria    OR</code></pre>
</div>
</div>
<div id="question-6-comment-on-the-summary-statistics-and-distribution-of-the-abv-variable." class="section level3">
<h3>Question 6: Comment on the summary statistics and distribution of the ABV variable.</h3>
<div id="we-see-that-most-beers-have-an-abv-in-the-rand-of-0.04-0.06.-but-the-presence-of-stronger-beers-skews-the-distribution-to-the-right." class="section level5">
<h5>We see that most beers have an ABV in the rand of 0.04-0.06. But the presence of stronger beers skews the distribution to the right.</h5>
<pre class="r"><code>summary(fullbeer$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.00100 0.05000 0.05647 0.05975 0.06700 0.12800</code></pre>
<pre class="r"><code>fullbeer$ABV&lt;-round(fullbeer$ABV*100,digits=1)

fullbeer %&gt;%
  ggplot(aes(x = ABV, fill = &quot;red&quot;))+
  geom_histogram() +
  theme_clean() + 
  theme(legend.position = &quot;none&quot;) +
  ylab(&quot;Beer Count&quot;) +
  ggtitle(&quot;Histogram of Beer ABV&quot;)+
  xlab(&quot;ABV (%)&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>fullbeer %&gt;% 
  ggplot(aes(x = ABV, color = &quot;red&quot;)) +
  geom_density() + 
  theme_clean() +
  theme(legend.position = &quot;none&quot;) +
  ggtitle(&quot;Density plot of Beer ABV&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code># Very right skewed distribution. Most beers are in the range of 0.04 - 0.06.</code></pre>
</div>
</div>
<div id="question-7-is-there-an-apparent-relationship-between-the-bitterness-of-the-beer-and-its-alcoholic-content-draw-a-scatter-plot.-make-your-best-judgment-of-a-relationship-and-explain-your-answer." class="section level3">
<h3>Question 7: Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot. Make your best judgment of a relationship and EXPLAIN your answer.</h3>
<div id="we-conclude-that-there-is-a-moderate-correlation-between-the-bitterness-and-alcoholic-content-of-a-beer.-in-general-we-do-see-as-abv-increases-ibu-increases.-there-are-exceptions-to-the-rule-but-our-data-shows-this-trend." class="section level5">
<h5>We conclude that there is a moderate correlation between the bitterness and alcoholic content of a beer. In general, we do see as ABV increases, IBU increases. There are exceptions to the rule, but our data shows this trend.</h5>
<pre class="r"><code>library(ggpmisc)</code></pre>
<pre><code>## Warning: package &#39;ggpmisc&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Loading required package: ggpp</code></pre>
<pre><code>## Warning: package &#39;ggpp&#39; was built under R version 4.0.2</code></pre>
<pre><code>## 
## Attaching package: &#39;ggpp&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     annotate</code></pre>
<pre class="r"><code>my.formula = y ~ x
fullbeer %&gt;%
  ggplot(aes(x=ABV,y=IBU))+
  geom_point(position = &quot;jitter&quot;) +
  geom_smooth(method=&quot;lm&quot;, color = &quot;red&quot;) +
  stat_poly_eq(formula = my.formula, 
               aes(label = paste(..eq.label.., ..rr.label.., sep = &quot;~~~&quot;)), 
               parse = TRUE,
               label.y = 0.87,
               eq.x.rhs = &quot;ABV&quot;,
               eq.with.lhs = &quot;IBU~`=`~&quot;) +
  theme_clean() +
  ggtitle(&quot;IBU vs ABV&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="question-8-use-knn-classification-to-investigate-the-difference-between-ipas-and-other-types-of-ales-with-respect-to-ibu-and-abv." class="section level3">
<h3>Question 8: Use KNN classification to investigate the difference between IPAs and other types of Ales with respect to IBU and ABV.</h3>
<div id="we-were-able-to-tune-our-external-crossvalidation-model-to-have-relatively-high-accuracy-sensitivity-and-specificity-in-predicting-whether-a-beer-was-an-ale-or-an-ipa-just-by-using-abv-and-ibu.-this-indicates-that-in-general-there-may-be-a-difference-in-the-abv-and-ibu-distributions-of-ales-and-ipas." class="section level4">
<h4>We were able to tune our external crossvalidation model to have relatively high accuracy, sensitivity, and specificity in predicting whether a beer was an Ale or an IPA just by using ABV and IBU. This indicates that, in general, there may be a difference in the ABV and IBU distributions of Ales and IPA’s.</h4>
<pre class="r"><code>library(class)</code></pre>
<pre><code>## Warning: package &#39;class&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 4.0.2</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>#First we pull all the beers that are IPA&#39;s or have Ale in the name
IPAsandAles&lt;-fullbeer[grepl(&quot;IPA|Ale&quot;,fullbeer$Style),]

#Then we split the data into 2 groups: IPA&#39;s and Ales
IPAs &lt;- IPAsandAles[grepl(&quot;IPA|India Pale Ale&quot;, IPAsandAles$Style),]
Ales &lt;- IPAsandAles[!grepl(&quot;IPA|India Pale Ale&quot;, IPAsandAles$Style),]

#Create a new column to identify each beer as IPA or Ale and then re-combine datasets
IPAs$Class = &quot;IPA&quot;
Ales$Class = &quot;Ale&quot;
IPAsandAles &lt;- rbind(IPAs, Ales)

#Create new data frame from IPAsandAles that only includes IBU, ABV, and Class information.
IPAAle &lt;- data.frame(ABV = IPAsandAles$ABV, 
                     IBU = IPAsandAles$IBU, 
                     ZABV = scale(IPAsandAles$ABV),
                     ZIBU = scale(IPAsandAles$IBU),
                     Class = IPAsandAles$Class)

#We are first splitting our data into a training set and a validation set so we may assess in the end.

#Train 80% validate 20%
set.seed(1)
trainIndices = sample(1:dim(IPAAle)[1],round(.8* dim(IPAAle)[1]))
train = IPAAle[trainIndices,]
validate = IPAAle[-trainIndices,]

#To tune the hyperparameters, we did a for loop with cross validation and a for loop using our train set.

iterations = 1
numks = 30
masterAcc = matrix(nrow = iterations, ncol = numks)
masterSens = matrix(nrow = iterations, ncol = numks)
masterSpec = matrix(nrow = iterations, ncol = numks)
for(j in 1:iterations)
{
  for(i in 1:numks)
  {
    classifications = knn.cv(train[,c(3,4)],train$Class, prob = TRUE, k = i)
    CM = confusionMatrix(table(classifications,train$Class))
    masterAcc[j,i] = CM$overall[1]
    masterSens[j,i]=CM$byClass[1]
    masterSpec[j,i]=CM$byClass[2]
  }
}
MeanAcc = colMeans(masterAcc)
MeanSens=colMeans(masterSens)
MeanSpec = colMeans(masterSpec)

#Make plots to see the effect of K
par(mfrow=c(1,3))
CVAcc = data.frame(K = seq(1,numks,1), MeanAcc = MeanAcc)
CVAcc %&gt;% 
  ggplot(aes(K, MeanAcc)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Accuracy&quot;)+
  ggtitle(&quot;Effect of K on Accuracy (CV)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>CVSens = data.frame(K = seq(1,numks,1), MeanSens = MeanSens)
CVSens %&gt;% 
  ggplot(aes(K, MeanSens)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Sensitivity&quot;)+
  ggtitle(&quot;Effect of K on Sensitivity (CV)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>CVSpec = data.frame(K = seq(1,numks,1), MeanSpec = MeanSpec)
CVSpec %&gt;% 
  ggplot(aes(K, MeanSpec)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Specificity&quot;)+
  ggtitle(&quot;Effect of K on Specificity (CV)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre class="r"><code># This for loop creates 500 iterations of train/test splits (from the training data) to tune k using external cross validation

iterations = 500
numks = 30
masterAcc = matrix(nrow = iterations, ncol = numks)
masterSens = matrix(nrow = iterations, ncol = numks)
masterSpec = matrix(nrow = iterations, ncol = numks)
splitPerc=.75

for(j in 1:iterations)
{
  trainIndices = sample(1:dim(train)[1],round(splitPerc * dim(train)[1]))
  train1 = train[trainIndices,]
  test1 = train[-trainIndices,]
  for(i in 1:numks)
  {
    classifications = knn(train1[,c(3,4)],test1[,c(3,4)],train1$Class, prob = TRUE, k = i)
    CM = confusionMatrix(table(classifications,test1$Class))
    masterAcc[j,i] = CM$overall[1]
    masterSens[j,i] = CM$byClass[1]
    masterSpec[j,i] = CM$byClass[2]
  }
}

MeanAcc = colMeans(masterAcc)
MeanSens = colMeans(masterSens)
MeanSpec = colMeans(masterSpec)

kAcc = data.frame(K = seq(1,numks,1), Accuracy = MeanAcc)
kAcc %&gt;% 
  ggplot(aes(K, Accuracy)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Accuracy&quot;)+
  ggtitle(&quot;Effect of K on Accuracy (Train/Test Split)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
<pre class="r"><code>kSens = data.frame(K = seq(1,numks,1), Sensitivity = MeanSens)
kSens %&gt;% 
  ggplot(aes(K, Sensitivity)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Sensitivity&quot;)+
  ggtitle(&quot;Effect of K on Sensitivity (Train/Test Split)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-5.png" width="672" /></p>
<pre class="r"><code>kSpec = data.frame(K = seq(1,numks,1), Specificity = MeanSpec)
kSpec %&gt;% 
  ggplot(aes(K, MeanSpec)) +
  geom_point() +
  geom_line() +
  theme_clean() + 
  ylab(&quot;Specificity&quot;)+
  ggtitle(&quot;Effect of K on Specificity (Train/Test Split)&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-9-6.png" width="672" /></p>
<pre class="r"><code>classifications = knn(train[,c(3,4)],validate[,c(3,4)],train$Class, prob = TRUE, k = 21)
CM = confusionMatrix(table(classifications,validate$Class))
confusionMatrix(table(classifications,validate$Class))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                
## classifications Ale IPA
##             Ale 185  21
##             IPA  21  80
##                                           
##                Accuracy : 0.8632          
##                  95% CI : (0.8196, 0.8996)
##     No Information Rate : 0.671           
##     P-Value [Acc &gt; NIR] : 1.015e-14       
##                                           
##                   Kappa : 0.6901          
##                                           
##  Mcnemar&#39;s Test P-Value : 1               
##                                           
##             Sensitivity : 0.8981          
##             Specificity : 0.7921          
##          Pos Pred Value : 0.8981          
##          Neg Pred Value : 0.7921          
##              Prevalence : 0.6710          
##          Detection Rate : 0.6026          
##    Detection Prevalence : 0.6710          
##       Balanced Accuracy : 0.8451          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
<p>###Exploring a Naive Bayes model ##### We tried to use the Naive Bayes approach to see how it performed. We had our reservations because the Naive Bayes method assumes that the predicting variables have a normal distribution. As shown previously, both the ABV and IBU variables are skewed to the right. We tried it anyway, and found that the Naive-Bayes model seems to be robust to non-normality in this situation. This may be cool to explore later on.</p>
<pre class="r"><code>##Naive Bayes Exploration
library(e1071)</code></pre>
<pre><code>## Warning: package &#39;e1071&#39; was built under R version 4.0.2</code></pre>
<pre class="r"><code>model = naiveBayes(Class~ABV+IBU,data = train)
confusionMatrix(table(predict(model,validate[,c(1,2)]),as.factor(validate$Class)))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##       Ale IPA
##   Ale 186  20
##   IPA  20  81
##                                           
##                Accuracy : 0.8697          
##                  95% CI : (0.8268, 0.9053)
##     No Information Rate : 0.671           
##     P-Value [Acc &gt; NIR] : 9.98e-16        
##                                           
##                   Kappa : 0.7049          
##                                           
##  Mcnemar&#39;s Test P-Value : 1               
##                                           
##             Sensitivity : 0.9029          
##             Specificity : 0.8020          
##          Pos Pred Value : 0.9029          
##          Neg Pred Value : 0.8020          
##              Prevalence : 0.6710          
##          Detection Rate : 0.6059          
##    Detection Prevalence : 0.6710          
##       Balanced Accuracy : 0.8524          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
</div>
</div>
<div id="other-useful-inference-most-numerous-style-of-beer-in-each-state." class="section level3">
<h3>Other Useful Inference: Most numerous style of beer in each State.</h3>
<div id="many-states-had-ties." class="section level5">
<h5>Many states had ties.</h5>
</div>
<div id="we-discovered-that-in-a-majority-of-states-the-most-popular-style-of-beer-measured-by-number-of-individual-beers-of-each-style-by-state-was-american-ipa." class="section level5">
<h5>We discovered that in a majority of states the most popular style of beer (measured by number of individual beers of each style by state) was American IPA.</h5>
</div>
<div id="then-we-looked-at-the-prevalence-of-american-ipas-in-all-the-states.-while-some-states-such-as-california-indiana-oregon-and-washington-have-an-abundance-of-choices-of-american-ipas-much-of-the-us-does-not-have-the-same-production-of-unique-ipas.-this-could-be-an-untapped-market.-as-american-ipa-clearly-seems-to-be-the-favorite-beer-amongst-americans-some-parts-of-the-country-may-not-have-the-variety-of-american-ipas-that-other-parts-do." class="section level5">
<h5>Then we looked at the prevalence of American IPA’s in all the states. While some states such as California, Indiana, Oregon, and Washington have an abundance of choices of American IPA’s, much of the US does not have the same production of unique IPA’s. This could be an untapped market. As American IPA clearly seems to be the favorite beer amongst Americans, some parts of the country may not have the variety of American IPA’s that other parts do.</h5>
<pre class="r"><code>count_by_state&lt;-fullbeer%&gt;%group_by(State)%&gt;%count(Style)
max_counts_by_State&lt;-count_by_state%&gt;%group_by(State)%&gt;%summarize(n=max(n))
style_by_state&lt;-left_join(max_counts_by_State,count_by_state,by=c(&quot;State&quot;,&quot;n&quot;))
style_by_state$Style = as.factor(style_by_state$Style)

summary(style_by_state)</code></pre>
<pre><code>##      State          n                                     Style   
##   DC    : 8   Min.   : 1.000   American IPA                  :39  
##   SD    : 7   1st Qu.: 1.000   American Pale Ale (APA)       :19  
##   AR    : 5   Median : 3.000   American Blonde Ale           : 6  
##   IA    : 5   Mean   : 6.031   American Amber / Red Ale      : 4  
##   CT    : 3   3rd Qu.: 6.000   American Brown Ale            : 3  
##   GA    : 3   Max.   :45.000   American Double / Imperial IPA: 3  
##  (Other):65                    (Other)                       :22</code></pre>
<pre class="r"><code>most_popular_styles = 
  style_by_state %&gt;%
  group_by(Style) %&gt;%
  summarise(n = n())

most_popular_styles %&gt;%
  ggplot(aes(x = reorder(Style, n), y = n, fill = Style)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme_clean() +
  coord_flip() + 
  theme(legend.position = &quot;none&quot;) + 
  ylab( &quot;Frequency of Style&quot;) +
  xlab(&quot;Style&quot;) +
  ggtitle(&quot;Most Numerous Styles of Beers in All States&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>IPAState = count_by_state%&gt;%group_by(State)%&gt;%filter(Style == &quot;American IPA&quot;)
IPAState %&gt;%
  ggplot(aes(x = reorder(State, n), y = n, fill = State)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme_clean() +
  coord_flip() + 
  theme(legend.position = &quot;none&quot;) + 
  ylab(&quot;Number of American IPA&#39;s&quot;) +
  xlab(&quot;State&quot;) +
  ggtitle(&quot;Number of Unique American IPA&#39;s in each state&quot;)</code></pre>
<p><img src="Beers_Final_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>#We could make the conclusion that IPA&#39;s could be introduced into those markets that don&#39;t have many IPA&#39;s as that is the most popular class of beers in the states. 

max_style_by_state = style_by_state %&gt;% group_by(State) %&gt;% summarize(n= max(n))
summary(as.factor(style_by_state$Style))</code></pre>
<pre><code>##                    Abbey Single Ale                             Altbier 
##                                   0                                   0 
##              American Adjunct Lager            American Amber / Red Ale 
##                                   1                                   4 
##          American Amber / Red Lager                 American Barleywine 
##                                   1                                   0 
##                  American Black Ale                 American Blonde Ale 
##                                   1                                   6 
##                  American Brown Ale             American Dark Wheat Ale 
##                                   3                                   0 
##      American Double / Imperial IPA  American Double / Imperial Pilsner 
##                                   3                                   0 
##    American Double / Imperial Stout           American India Pale Lager 
##                                   0                                   0 
##                        American IPA                American Malt Liquor 
##                                  39                                   0 
##             American Pale Ale (APA)                 American Pale Lager 
##                                  19                                   0 
##             American Pale Wheat Ale                    American Pilsner 
##                                   2                                   1 
##                     American Porter                      American Stout 
##                                   3                                   0 
##                 American Strong Ale                  American White IPA 
##                                   0                                   0 
##                   American Wild Ale                       Baltic Porter 
##                                   0                                   0 
##                    Belgian Dark Ale                         Belgian IPA 
##                                   0                                   0 
##                    Belgian Pale Ale             Belgian Strong Dark Ale 
##                                   1                                   0 
##             Belgian Strong Pale Ale                  Berliner Weissbier 
##                                   0                                   1 
##                      Bière de Garde                                Bock 
##                                   0                                   0 
##                             Braggot      California Common / Steam Beer 
##                                   0                                   0 
##                          Chile Beer                               Cider 
##                                   0                                   0 
##                           Cream Ale                      Czech Pilsener 
##                                   1                                   0 
##                          Doppelbock           Dortmunder / Export Lager 
##                                   0                                   0 
##                              Dubbel                        Dunkelweizen 
##                                   0                                   0 
##                  English Barleywine                      English Bitter 
##                                   0                                   0 
##                   English Brown Ale               English Dark Mild Ale 
##                                   0                                   0 
##        English India Pale Ale (IPA)                    English Pale Ale 
##                                   0                                   0 
##               English Pale Mild Ale                       English Stout 
##                                   0                                   0 
##                  English Strong Ale                     Euro Dark Lager 
##                                   0                                   0 
##                     Euro Pale Lager Extra Special / Strong Bitter (ESB) 
##                                   0                                   1 
##                  Flanders Oud Bruin                    Flanders Red Ale 
##                                   0                                   0 
##              Foreign / Export Stout              Fruit / Vegetable Beer 
##                                   0                                   0 
##                     German Pilsener                                Gose 
##                                   0                                   0 
##                            Grisette                          Hefeweizen 
##                                   0                                   1 
##                Herbed / Spiced Beer                     Irish Dry Stout 
##                                   1                                   0 
##                       Irish Red Ale          Keller Bier / Zwickel Bier 
##                                   1                                   0 
##                              Kölsch                       Kristalweizen 
##                                   0                                   0 
##                         Light Lager                    Low Alcohol Beer 
##                                   0                                   0 
##               MÃ¤rzen / Oktoberfest               Maibock / Helles Bock 
##                                   0                                   0 
##                Märzen / Oktoberfest                                Mead 
##                                   1                                   0 
##                  Milk / Sweet Stout                 Munich Dunkel Lager 
##                                   0                                   0 
##                 Munich Helles Lager                       Oatmeal Stout 
##                                   0                                   1 
##                             Old Ale                               Other 
##                                   0                                   0 
##                         Pumpkin Ale                    Quadrupel (Quad) 
##                                   0                                   0 
##                              Radler                           Rauchbier 
##                                   0                                   0 
##                          Roggenbier              Russian Imperial Stout 
##                                   0                                   0 
##                            Rye Beer              Saison / Farmhouse Ale 
##                                   0                                   0 
##                         Schwarzbier              Scotch Ale / Wee Heavy 
##                                   1                                   1 
##                        Scottish Ale                              Shandy 
##                                   1                                   0 
##                         Smoked Beer                              Tripel 
##                                   0                                   0 
##                        Vienna Lager                           Wheat Ale 
##                                   0                                   0 
##                       Winter Warmer                             Witbier 
##                                   0                                   1</code></pre>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
